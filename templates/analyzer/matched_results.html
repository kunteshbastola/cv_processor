{% extends "home.html" %}
{% block content %}

<h2>Matched CVs for "{{ job_title|default:'N/A' }}"</h2>

{% if error_message %}
  <p style="color:red;">{{ error_message }}</p>
{% endif %}

{% if cvs %}
  <div class="cv-list">
    {% for cv in cvs %}
      <div class="cv-card" style="border:1px solid #ccc; padding:15px; margin-bottom:20px;">
        <h3>{{ cv.filename|default:"N/A" }}</h3>
        <p><strong>Overall Score:</strong> {{ cv.overall_score|default:"0" }}%</p>
        <p><strong>Matching Score:</strong> {{ cv.matching_score|default:"0" }}%</p>

        {% if cv.skills %}
          <p><strong>Skills:</strong> {{ cv.skills|truncatechars:50|default:"N/A" }}</p>
        {% endif %}

        <button type="button" onclick="toggleDetails('details-{{ cv.id }}')">View More</button>
        <div id="details-{{ cv.id }}" style="display:none; margin-top:10px;">
          <p><strong>Experience:</strong><br>{{ cv.experience|linebreaks|default:"N/A" }}</p>
          <p><strong>Education:</strong><br>{{ cv.education|linebreaks|default:"N/A" }}</p>
          <p><strong>Skills:</strong><br>{{ cv.skills|linebreaks|default:"N/A" }}</p>

          <h4>Section Scores:</h4>
          <ul>
            <li>Contact: {{ cv.contact_score|default:"0" }}%</li>
            <li>Experience: {{ cv.experience_score|default:"0" }}%</li>
            <li>Education: {{ cv.education_score|default:"0" }}%</li>
            <li>Skills: {{ cv.skills_score|default:"0" }}%</li>
            <li>Format: {{ cv.format_score|default:"0" }}%</li>
          </ul>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <p>No CVs matched yet.</p>
{% endif %}

<script>
function toggleDetails(id) {
    var elem = document.getElementById(id);
    elem.style.display = (elem.style.display === "none") ? "block" : "none";
}
</script>

{% endblock %}
