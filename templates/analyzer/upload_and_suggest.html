{% extends 'analyzer/base.html' %}

{% block title %}Get Suggestions - CV Analyzer{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card shadow">
            <div class="card-header bg-warning text-dark">
                <h3 class="mb-0">
                    <i class="fas fa-lightbulb me-2"></i>Get CV Improvement Suggestions
                </h3>
            </div>
            <div class="card-body">
                <p class="text-muted mb-4">
                    Upload a single CV and get AI-powered suggestions to improve it for a specific job role.
                </p>

                <form method="POST" enctype="multipart/form-data" id="suggestForm">
                    {% csrf_token %}
                    
                    <div class="row">
                        <div class="col-md-6 mb-4">
                            <div class="form-group">
                                <label for="job_name" class="form-label fw-bold">
                                    <i class="fas fa-bullseye me-2"></i>Target Job Role
                                </label>
                                <input type="text" 
                                       name="job_name" 
                                       id="job_name"
                                       class="form-control" 
                                       placeholder="e.g., Machine Learning Engineer"
                                       required>
                                <small class="text-muted">The job you're applying for</small>
                            </div>
                        </div>
                        
                        <div class="col-md-6 mb-4">
                            <div class="form-group">
                                <label for="file" class="form-label fw-bold">
                                    <i class="fas fa-file-upload me-2"></i>Upload Your CV
                                </label>
                                <input type="file" 
                                       name="file" 
                                       id="file"
                                       class="form-control" 
                                       accept=".pdf,.doc,.docx,.txt"
                                       required>
                                <small class="text-muted">PDF, DOC, DOCX, TXT (Max 5MB)</small>
                            </div>
                        </div>
                    </div>

                    <!-- File Preview -->
                    <div class="mb-4" id="suggestFilePreview" style="display: none;">
                        <div class="card">
                            <div class="card-header bg-light">
                                <h6 class="mb-0">Selected File</h6>
                            </div>
                            <div class="card-body" id="selectedFileInfo"></div>
                        </div>
                    </div>

                    <!-- Quick Tips -->
                    <div class="alert alert-info">
                        <h6><i class="fas fa-tips me-2"></i>Tips for Best Results:</h6>
                        <ul class="mb-0">
                            <li>Make sure your CV is readable and well-formatted</li>
                            <li>Include all relevant experience, education, and skills</li>
                            <li>Be specific about the target job role</li>
                            <li>Use standard file formats for better parsing</li>
                        </ul>
                    </div>

                    <!-- Submit Button -->
                    <div class="d-grid">
                        <button type="submit" class="btn btn-warning btn-lg" id="analyzeBtn">
                            <i class="fas fa-magic me-2"></i>Get AI Suggestions
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Example Suggestions -->
        <div class="card shadow mt-4">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0">
                    <i class="fas fa-eye me-2"></i>What to Expect
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6><i class="fas fa-chart-pie text-primary me-2"></i>Scoring Areas:</h6>
                        <ul>
                            <li>Contact Information Completeness</li>
                            <li>Relevance of Experience</li>
                            <li>Education Alignment</li>
                            <li>Skills Match</li>
                            <li>Formatting & Readability</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6><i class="fasfa-comment-dots text-success me-2"></i>Types of Suggestions:</h6>
                        <ul>
                            <li>Keyword optimization</li>
                            <li>Formatting improvements</li>
                            <li>Skill highlighting</li>
                            <li>Experience restructuring</li>
                            <li>ATS compatibility tips</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
$(document).ready(function() {
    // File selection preview
    $('#file').on('change', function() {
        const file = $(this)[0].files[0];
        if (file) {
            const fileSize = (file.size / 1024 / 1024).toFixed(2);
            const fileType = file.name.split('.').pop().toUpperCase();
            
            $('#selectedFileInfo').html(`
                <div class="d-flex align-items-center">
                    <div class="me-3">
                        <i class="fas fa-file fa-3x text-primary"></i>
                    </div>
                    <div>
                        <h6 class="mb-1">${file.name}</h6>
                        <p class="mb-0 text-muted">
                            <span class="badge bg-info me-2">${fileType}</span>
                            <span class="badge bg-secondary">${fileSize} MB</span>
                        </p>
                        <small>Last modified: ${new Date(file.lastModified).toLocaleDateString()}</small>
                    </div>
                </div>
            `);
            $('#suggestFilePreview').show();
        } else {
            $('#suggestFilePreview').hide();
        }
    });
    
    // Form submission
    $('#suggestForm').on('submit', function() {
        $('#analyzeBtn').prop('disabled', true);
        $('#analyzeBtn').html('<i class="fas fa-spinner fa-spin me-2"></i>Analyzing...');
    });
});
</script>
{% endblock %}